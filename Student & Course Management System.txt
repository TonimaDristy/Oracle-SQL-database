-- Create table
CREATE TABLE students (
    id NUMBER PRIMARY KEY,
    name VARCHAR2(50),
    age NUMBER,
    department VARCHAR2(50),
    marks NUMBER
);

-- Insert data
INSERT INTO students VALUES (1, 'Rahim', 20, 'CSE', 85);
INSERT INTO students VALUES (2, 'Karim', 22, 'EEE', 78);
INSERT INTO students VALUES (3, 'Ayesha', 21, 'CSE', 92);

-- View all data
SELECT * FROM students;

-- Select specific columns
SELECT name, department FROM students;

-- Where condition
SELECT * FROM students WHERE department = 'CSE';

-- Order by
SELECT * FROM students ORDER BY marks DESC;

-- Aggregate functions
SELECT AVG(marks) AS avg_marks FROM students;
SELECT MAX(marks) AS max_marks FROM students;
SELECT COUNT(*) AS total_students FROM students;

-- Group by
SELECT department, AVG(marks) AS avg_marks
FROM students
GROUP BY department;

-- Update
UPDATE students SET marks = 90 WHERE id = 2;

-- Delete
DELETE FROM students WHERE id = 1;

-- Second table
CREATE TABLE courses (
    course_id NUMBER,
    student_id NUMBER,
    course_name VARCHAR2(50)
);

INSERT INTO courses VALUES (101, 2, 'Database Systems');
INSERT INTO courses VALUES (102, 3, 'AI Basics');

-- Join query
SELECT s.name, c.course_name
FROM students s
JOIN courses c ON s.id = c.student_id;

-- Subquery
SELECT name
FROM students
WHERE marks > (SELECT AVG(marks) FROM students);
